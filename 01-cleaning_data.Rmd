---
title: "Richi motivazione"
author: "Anna Quaglieri & Riccardo Amorati"
date: "27/08/2017"
output:
  html_document:
    toc: yes
    toc_depth: 3
  pdf_document:
    toc: yes
    toc_depth: 3
---

# Read in data

```{r setup, include=FALSE, eval=TRUE,echo=TRUE}
# Load packages
library(readxl)
library(dplyr)
library(tidyr)
library(readr)

# Chunk options
knitr::opts_chunk$set(echo = TRUE, prompt = TRUE)

```

```{r echo = TRUE}
english_in_germany <- read_excel("english_in_germany.xlsx", skip = 1)
colnames(english_in_germany) <- gsub("\n","",colnames(english_in_germany))
colnames(english_in_germany) <- gsub("\r\n","",colnames(english_in_germany))
colnames(english_in_germany) <- gsub("\r","",colnames(english_in_germany))

english_in_italy <- read_excel("english_in_italy.xlsx", skip = 1)
colnames(english_in_italy) <- gsub("\n","",colnames(english_in_italy))
colnames(english_in_italy) <- gsub("\r\n","",colnames(english_in_italy))
colnames(english_in_italy) <- gsub("\r","",colnames(english_in_italy))

german_in_australia <- read_excel("german_in_australia.xlsx", skip = 1)
colnames(german_in_australia) <- gsub("\n","",colnames(german_in_australia))
colnames(german_in_australia) <- gsub("\r\n","",colnames(german_in_australia))
colnames(german_in_australia) <- gsub("\r","",colnames(german_in_australia))

italian_in_australia <- read_excel("italian_in_australia.xlsx")
colnames(italian_in_australia) <- gsub("\n","",colnames(italian_in_australia))
colnames(italian_in_australia) <- gsub("\r\n","",colnames(italian_in_australia))
colnames(italian_in_australia) <- gsub("\r","",colnames(italian_in_australia))
```

# Restructure variable

## English in Germany

- Attributes variable

```{r}
var <- colnames(english_in_germany)[grep(".attrib",colnames(english_in_germany))]
attrib <- english_in_germany[,var]
table(attrib[,1])
table(attrib[,2])
table(attrib[,3])
table(attrib[,4])
table(attrib[,5])
table(attrib[,6])
table(attrib[,7])
table(attrib[,8])
table(attrib[,9])

english_in_germany$succ1.attrib <- ifelse(is.na(english_in_germany$succ1.attrib),0,1)
english_in_germany$educ2.attrib <- ifelse(is.na(english_in_germany$educ2.attrib),0,1)
english_in_germany$open3.attrib <- ifelse(is.na(english_in_germany$open3.attrib),0,1)
english_in_germany$élite4.attrib <- ifelse(is.na(english_in_germany$élite4.attrib),0,1)
english_in_germany$citizen5.attrib <- ifelse(is.na(english_in_germany$citizen5.attrib),0,1)
english_in_germany$employable6.attrib <- ifelse(is.na(english_in_germany$employable6.attrib),0,1)
english_in_germany$cultured7.attrib <- ifelse(is.na(english_in_germany$cultured7.attrib),0,1)
english_in_germany$interesting8.attrib <- ifelse(is.na(english_in_germany$interesting8.attrib),0,1)
```

- External influence
 
```{r}
var <- colnames(english_in_germany)[grep(".external",colnames(english_in_germany))]
var <- var[-8]
external <- english_in_germany[,var]
table(external[,1])
table(external[,2])
table(external[,3])
table(external[,4])
table(external[,5])
table(external[,6])
table(external[,7])

english_in_germany[,var[1]] <- ifelse(is.na(english_in_germany[,var[1]]),0,1)
english_in_germany[,var[2]] <- ifelse(is.na(english_in_germany[,var[2]]),0,1)
english_in_germany[,var[3]] <- ifelse(is.na(english_in_germany[,var[3]]),0,1)
english_in_germany[,var[4]] <- ifelse(is.na(english_in_germany[,var[4]]),0,1)
english_in_germany[,var[5]] <- ifelse(is.na(english_in_germany[,var[5]]),0,1)
english_in_germany[,var[6]] <- ifelse(is.na(english_in_germany[,var[6]]),0,1)
```

- Other external influence
 
In English in Germany there is only one column for this variable because they could onyl choose one option. In some other context they could choose more than one option so to make it comparable we will split into 4 variables.
 
```{r}
# Other external influence
# encouragement1.influence
# insistence2.influence
# pressure3.influence
# other4.influence

# need to separate it into 4 parts
table(english_in_germany$external.influence,useNA = "always")
colnames(english_in_germany)[which(colnames(english_in_germany) == "external.influence")] <- "encouragement1.influence"
colnames(english_in_germany)[which(colnames(english_in_germany) == "other.external.influence")] <- "other4.influence"

namesInfl <- names(table(english_in_germany$encouragement1.influence))
english_in_germany$encouragement1.influence[english_in_germany$encouragement1.influence == namesInfl[2]] <- 0
english_in_germany$encouragement1.influence[english_in_germany$encouragement1.influence == namesInfl[1]] <- 1

english_in_germany$insistence2.influence <- 0
english_in_germany$insistence2.influence[is.na(english_in_germany$encouragement1.influence)] <- NA
english_in_germany$pressure3.influence <- 0
english_in_germany$pressure3.influence[is.na(english_in_germany$encouragement1.influence)] <- NA

```

- Sector variable
 
```{r}
var <- colnames(english_in_germany)[grep("sector",colnames(english_in_germany))]
sector <- english_in_germany[,var]
table(sector[,1],useNA = "always")
table(sector[,2],useNA = "always")
table(sector[,3],useNA = "always")
table(sector[,4],useNA = "always")
table(sector[,5],useNA = "always")
table(sector[,6],useNA = "always")
table(sector[,7],useNA = "always")
table(sector[,8],useNA = "always")
table(sector[,9],useNA = "always")
table(sector[,10],useNA = "always")
table(sector[,11],useNA = "always")

english_in_germany[,var[1]] <- ifelse(is.na(english_in_germany[,var[1]]),0,1)
english_in_germany[,var[2]] <- ifelse(is.na(english_in_germany[,var[2]]),0,1)
english_in_germany[,var[3]] <- ifelse(is.na(english_in_germany[,var[3]]),0,1)
english_in_germany[,var[4]] <- ifelse(is.na(english_in_germany[,var[4]]),0,1)
english_in_germany[,var[5]] <- ifelse(is.na(english_in_germany[,var[5]]),0,1)
english_in_germany[,var[6]] <- ifelse(is.na(english_in_germany[,var[6]]),0,1)
english_in_germany[,var[7]] <- ifelse(is.na(english_in_germany[,var[7]]),0,1)
english_in_germany[,var[8]] <- ifelse(is.na(english_in_germany[,var[8]]),0,1)
english_in_germany[,var[9]] <- ifelse(is.na(english_in_germany[,var[9]]),0,1)
english_in_germany[,var[10]] <- ifelse(is.na(english_in_germany[,var[10]]),0,1)

colnames(english_in_germany)[which(colnames(english_in_germany) == "intrelations.9sector")] <- "intrelations9.sector"
```

- Demographics
 
```{r}
table(english_in_germany$Age)
table(english_in_germany$Gender)

english_in_germany <- english_in_germany %>% tidyr::separate(Gender,into = c("Gender","Gender.translate"),sep=" /")
table(english_in_germany$Gender,useNA = "always")
english_in_germany$Gender[english_in_germany$Gender == names(table(english_in_germany$Gender))[3]] <- "Other"
english_in_germany$Gender.translate <- NULL
```

- First Language
 
```{r}
table(english_in_germany$L1)
namesL1 <- names(table(english_in_germany$L1))
english_in_germany$L1 <- ifelse(english_in_germany$L1 == namesL1[2],english_in_germany$other.other.L1,english_in_germany$L1)
namesL1 <- names(table(english_in_germany$L1))
english_in_germany$L1[english_in_germany$L1 == namesL1[1]] <- "German and English"
english_in_germany$L1[english_in_germany$L1 == namesL1[5]] <- "German"
english_in_germany$L1[english_in_germany$L1 == namesL1[6]] <- "German and Turkish"
table(english_in_germany$L1)

english_in_germany$other.other.L1 <- NULL
```

- Other languages
 
```{r}
# speak other
table(english_in_germany$speak.other.L2,useNA = "always")
english_in_germany <- english_in_germany %>% tidyr::separate(speak.other.L2,into=c("speak.other.L2","speak.other.L2.translate"),sep=" / ")
english_in_germany$speak.other.L2.translate <- NULL

# study other
table(english_in_germany$study.other.L2,useNA = "always")
english_in_germany <- english_in_germany %>% tidyr::separate(study.other.L2,into=c("study.other.L2.translate","study.other.L2"),sep=" / ")
english_in_germany$study.other.L2.translate <- NULL
english_in_germany$study.other.L2[english_in_germany$study.other.L2 == "Ja"] <- "Yes"

# merge with the language studied - could be better
english_in_germany$study.other.L2 <- ifelse(english_in_germany$study.other.L2 == "Yes",english_in_germany$specify.study.otherL2,english_in_germany$study.other.L2)
english_in_germany$specify.study.otherL2 <- NULL
```

- Origin
 
```{r}
table(english_in_germany$origins,useNA = "always")
english_in_germany <- english_in_germany %>% 
  tidyr::separate(origins,into=c("origins","origins.translate"),sep=" / ")
english_in_germany$origins.translate <- NULL
```

- Year study L2
 
```{r}
table(english_in_germany$year.studyL2)
namesL2 <- names(table(english_in_germany$year.studyL2))
english_in_germany$year.studyL2 <- ifelse(english_in_germany$year.studyL2 == namesL2[3],"Other",
                                ifelse(english_in_germany$year.studyL2 == namesL2[1],"First year of primary school",english_in_germany$year.studyL2))
```


### **Richi needs to make macro classes of the 'other' for this variable**

-  Other ways of studying languages

```{r}
var <- colnames(english_in_germany)[grep(".other.ways",colnames(english_in_germany))]
otherways <- english_in_germany[,var]
table(otherways[,1],useNA = "always")
table(otherways[,2],useNA = "always")
table(otherways[,3],useNA = "always")
table(otherways[,4],useNA = "always")
table(otherways[,5],useNA = "always")

english_in_germany[,var[1]] <- ifelse(is.na(english_in_germany[,var[1]]),0,1)
english_in_germany[,var[2]] <- ifelse(is.na(english_in_germany[,var[2]]),0,1)
english_in_germany[,var[3]] <- ifelse(is.na(english_in_germany[,var[3]]),0,1)
english_in_germany[,var[4]] <- ifelse(is.na(english_in_germany[,var[4]]),0,1)
```

-  Degree

### **Richi needs to create macro degree areas for the other variable**

```{r}
table(english_in_germany$degree)
namesDegree <- names(table(english_in_germany$degree))
english_in_germany$degree <- ifelse(english_in_germany$degree == namesDegree[4],"Other",english_in_germany$degree)
```

- Minor study 

```{r}
var <- colnames(english_in_germany)[grep("minor",colnames(english_in_germany))]
otherways <- english_in_germany[,var]
table(otherways[,1],useNA = "always")
table(otherways[,2],useNA = "always")
table(otherways[,3],useNA = "always")
table(otherways[,4],useNA = "always")
table(otherways[,5],useNA = "always")
table(otherways[,6],useNA = "always")
table(otherways[,7],useNA = "always")
table(otherways[,8],useNA = "always")
table(otherways[,9],useNA = "always")
table(otherways[,10],useNA = "always")

english_in_germany[,var[1]] <- ifelse(is.na(english_in_germany[,var[1]]),0,1)
english_in_germany[,var[2]] <- ifelse(is.na(english_in_germany[,var[2]]),0,1)
english_in_germany[,var[3]] <- ifelse(is.na(english_in_germany[,var[3]]),0,1)
english_in_germany[,var[4]] <- ifelse(is.na(english_in_germany[,var[4]]),0,1)
english_in_germany[,var[5]] <- ifelse(is.na(english_in_germany[,var[5]]),0,1)
english_in_germany[,var[6]] <- ifelse(is.na(english_in_germany[,var[6]]),0,1)
english_in_germany[,var[7]] <- ifelse(is.na(english_in_germany[,var[7]]),0,1)
english_in_germany[,var[8]] <- ifelse(is.na(english_in_germany[,var[8]]),0,1)
english_in_germany[,var[9]] <- ifelse(is.na(english_in_germany[,var[9]]),0,1)
english_in_germany[,var[10]] <- ifelse(is.na(english_in_germany[,var[10]]),0,1)
english_in_germany[,var[11]] <- ifelse(is.na(english_in_germany[,var[11]]),0,1)
english_in_germany[,var[12]] <- ifelse(is.na(english_in_germany[,var[12]]),0,1)
english_in_germany[,var[13]] <- ifelse(is.na(english_in_germany[,var[13]]),0,1)
english_in_germany[,var[14]] <- ifelse(is.na(english_in_germany[,var[14]]),0,1)
english_in_germany[,var[15]] <- ifelse(is.na(english_in_germany[,var[15]]),0,1)
english_in_germany[,var[16]] <- ifelse(is.na(english_in_germany[,var[16]]),0,1)
```

- Semester

```{r}

namesSem <- names(table(english_in_germany$semester.of.enrolment.year))

english_in_germany <- english_in_germany %>% tidyr::separate(semester.of.enrolment.year,into=c("semester.of.enrolment.year","semester.of.enrolment.year.translate"),sep=" / ")
table(english_in_germany$semester.of.enrolment.year)

english_in_germany$semester.of.enrolment.year <- ifelse(english_in_germany$semester.of.enrolment.year == namesSem[6], english_in_germany$other.semester.of.enrolment.year,english_in_germany$semester.of.enrolment.year)
namesSem <- names(table(english_in_germany$semester.of.enrolment.year))

english_in_germany$semester.of.enrolment.year[english_in_germany$semester.of.enrolment.year == namesSem[3]] <- namesSem[4]

english_in_germany$other.semester.of.enrolment.year <- NULL
english_in_germany$semester.of.enrolment.year.translate <- NULL

# Change column name to year so that it is consistent with the other contexts
colnames(english_in_germany)[which(colnames(english_in_germany) == "semester.of.enrolment.year")] <- "study.year"
```

-  Proficiency 

```{r}
# Proficiency
table(english_in_germany$prof)
namesProf <- names(table(english_in_germany$prof))
english_in_germany <- english_in_germany %>% 
  tidyr::separate(prof,into=c("prof","prof.translate"),sep=" /")
english_in_germany$prof[english_in_germany$prof == namesProf[3]] <- "Upper-intermediate"
table(english_in_germany$prof)
english_in_germany$prof.translate <- NULL
```

- Context Group 

```{r}
english_in_germany$Context <- "English in Germany"
write.csv(english_in_germany,"english_in_germany_cleaned.csv",row.names = FALSE)
```

## English in Italy

- Attributes variable

```{r}
var <- colnames(english_in_italy)[grep(".attrib",colnames(english_in_italy))]
attrib <- english_in_italy[,var]
table(attrib[,1])
table(attrib[,2])
table(attrib[,3])
table(attrib[,4])
table(attrib[,5])
table(attrib[,6])
table(attrib[,7])
table(attrib[,8])
table(attrib[,9])

english_in_italy$succ1.attrib <- ifelse(is.na(english_in_italy$succ1.attrib),0,1)
english_in_italy$educ2.attrib <- ifelse(is.na(english_in_italy$educ2.attrib),0,1)
english_in_italy$open3.attrib <- ifelse(is.na(english_in_italy$open3.attrib),0,1)
english_in_italy$élite4.attrib <- ifelse(is.na(english_in_italy$élite4.attrib),0,1)
english_in_italy$citizen5.attrib <- ifelse(is.na(english_in_italy$citizen5.attrib),0,1)
english_in_italy$employable6.attrib <- ifelse(is.na(english_in_italy$employable6.attrib),0,1)
english_in_italy$cultured7.attrib <- ifelse(is.na(english_in_italy$cultured7.attrib),0,1)
english_in_italy$interesting8.attrib <- ifelse(is.na(english_in_italy$interesting8.attrib),0,1)
```

- External influence

```{r}
var <- colnames(english_in_italy)[grep(".external",colnames(english_in_italy))]
var <- var[-8]
external <- english_in_italy[,var]
table(external[,1])
table(external[,2])
table(external[,3])
table(external[,4])
table(external[,5])
table(external[,6])
table(external[,7])

english_in_italy[,var[1]] <- ifelse(is.na(english_in_italy[,var[1]]),0,1)
english_in_italy[,var[2]] <- ifelse(is.na(english_in_italy[,var[2]]),0,1)
english_in_italy[,var[3]] <- ifelse(is.na(english_in_italy[,var[3]]),0,1)
english_in_italy[,var[4]] <- ifelse(is.na(english_in_italy[,var[4]]),0,1)
english_in_italy[,var[5]] <- ifelse(is.na(english_in_italy[,var[5]]),0,1)
english_in_italy[,var[6]] <- ifelse(is.na(english_in_italy[,var[6]]),0,1)
```

- Other External influence

```{r}
##########################
# Other external influence: it is conditioned to previous questio
# encouragement1.influence
# insistence2.influence
# pressure3.influence
# other4.influence

# need to separate it into 4 parts
table(english_in_italy$external.influence,useNA = "always")
english_in_italy <- english_in_italy %>% tidyr::separate(external.influence,into=c("external.influence","external.influence.translate"),sep=" /")
namesExt <- names(table(english_in_italy$external.influence))
english_in_italy$external.influence[english_in_italy$external.influence == namesExt[1]] <- "Encouragement"
namesExt <- names(table(english_in_italy$external.influence))

# spread
english_in_italy$external.influence[is.na(english_in_italy$external.influence)] <- 0
english_in_italy$encouragement1.influence <- ifelse(english_in_italy$external.influence == namesExt[1],1,0)
english_in_italy$insistence2.influence <- ifelse(english_in_italy$external.influence == namesExt[2],1,0)
english_in_italy$pressure3.influence <- ifelse(english_in_italy$external.influence == namesExt[4],1,0)
english_in_italy$other4.influence <- ifelse(english_in_italy$external.influence == namesExt[3],english_in_italy$other.external.influence,NA)

english_in_italy$encouragement1.influence[english_in_italy$external.influence == 0] <- NA
english_in_italy$insistence2.influence[english_in_italy$external.influence == 0] <- NA
english_in_italy$pressure3.influence[english_in_italy$external.influence == 0] <- NA
english_in_italy$other4.influence[english_in_italy$external.influence == 0] <- NA

english_in_italy$external.influence <- NULL
english_in_italy$external.influence.translate <- NULL
english_in_italy$other.external.influence <- NULL

# check consistenc

table(english_in_italy$encouragement1.influence,english_in_italy$insistence2.influence,useNA = "always")

```

- Sector variable

```{r}
# Sector variable
var <- colnames(english_in_italy)[grep("sector",colnames(english_in_italy))]
sector <- english_in_italy[,var]
table(sector[,1],useNA = "always")
table(sector[,2],useNA = "always")
table(sector[,3],useNA = "always")
table(sector[,4],useNA = "always")
table(sector[,5],useNA = "always")
table(sector[,6],useNA = "always")
table(sector[,7],useNA = "always")
table(sector[,8],useNA = "always")
table(sector[,9],useNA = "always")
table(sector[,10],useNA = "always")
table(sector[,11],useNA = "always")

english_in_italy[,var[1]] <- ifelse(is.na(english_in_italy[,var[1]]),0,1)
english_in_italy[,var[2]] <- ifelse(is.na(english_in_italy[,var[2]]),0,1)
english_in_italy[,var[3]] <- ifelse(is.na(english_in_italy[,var[3]]),0,1)
english_in_italy[,var[4]] <- ifelse(is.na(english_in_italy[,var[4]]),0,1)
english_in_italy[,var[5]] <- ifelse(is.na(english_in_italy[,var[5]]),0,1)
english_in_italy[,var[6]] <- ifelse(is.na(english_in_italy[,var[6]]),0,1)
english_in_italy[,var[7]] <- ifelse(is.na(english_in_italy[,var[7]]),0,1)
english_in_italy[,var[8]] <- ifelse(is.na(english_in_italy[,var[8]]),0,1)
english_in_italy[,var[9]] <- ifelse(is.na(english_in_italy[,var[9]]),0,1)
english_in_italy[,var[10]] <- ifelse(is.na(english_in_italy[,var[10]]),0,1)

colnames(english_in_italy)[which(colnames(english_in_italy) == "intrelations.9sector")] <- "intrelations9.sector"
```

- Demographics

```{r}
# Demographics
table(english_in_italy$Age)
table(english_in_italy$Gender)

english_in_italy <- english_in_italy %>% tidyr::separate(Gender,into = c("Gender","Gender.translate"),sep=" /")
table(english_in_italy$Gender,useNA = "always")
english_in_italy$Gender[english_in_italy$Gender == names(table(english_in_italy$Gender))[3]] <- "Other"
english_in_italy$Gender.translate <- NULL
```

- First Language

```{r}
# First language
table(english_in_italy$L1)
namesL1 <- names(table(english_in_italy$L1))
english_in_italy$L1 <- ifelse(english_in_italy$L1 == namesL1[2],english_in_italy$other.other.L1,english_in_italy$L1)
namesL1 <- names(table(english_in_italy$L1))
english_in_italy$L1[english_in_italy$L1 == namesL1[1]] <- "Albanian"
english_in_italy$L1[english_in_italy$L1 == namesL1[3]] <- "Chinese"
english_in_italy$L1[english_in_italy$L1 == namesL1[4]] <- "Chinese"
english_in_italy$L1[english_in_italy$L1 == namesL1[5]] <- "Italian"

table(english_in_italy$L1)

english_in_italy$other.other.L1 <- NULL

```

- Other languages

```{r}
# Speak other languages
table(english_in_italy$speak.other.L2,useNA = "always")
english_in_italy <- english_in_italy %>% tidyr::separate(speak.other.L2,into=c("speak.other.L2","speak.other.L2.transale"),sep=" / ")
english_in_italy$speak.other.L2.transale <- NULL

# other.speak.other.L2 -> convert into numbers?
```

The following question is Yes/No in english_in_germany and also in the other contexts apart from english_in_italy. For the moment we leave it qualitative for this context.

```{r}
# study other languages - could be better
table(english_in_italy$study.other.L2,useNA = "always")
```

- Origin

```{r}
table(english_in_italy$origins,useNA = "always")
```

- Year study L2

*Richi needs to make macro classes of the 'other' for this variable*

```{r}
# year study L2
table(english_in_italy$year.studyL2,useNA = "always")
namesL2 <- names(table(english_in_italy$year.studyL2))
english_in_italy$year.studyL2 <- ifelse(english_in_italy$year.studyL2 == namesL2[3],"Other",
                                ifelse(english_in_italy$year.studyL2 == namesL2[1],"First year of primary school",
                                       ifelse(english_in_italy$year.studyL2 == namesL2[2],"Kindergarten",english_in_italy$year.studyL2)))

```

- Other ways of studying languages

```{r}
var <- colnames(english_in_italy)[grep(".other.ways",colnames(english_in_italy))]
otherways <- english_in_italy[,var]
table(otherways[,1],useNA = "always")
table(otherways[,2],useNA = "always")
table(otherways[,3],useNA = "always")
table(otherways[,4],useNA = "always")
table(otherways[,5],useNA = "always")

english_in_italy[,var[1]] <- ifelse(is.na(english_in_italy[,var[1]]),0,1)
english_in_italy[,var[2]] <- ifelse(is.na(english_in_italy[,var[2]]),0,1)
english_in_italy[,var[3]] <- ifelse(is.na(english_in_italy[,var[3]]),0,1)
english_in_italy[,var[4]] <- ifelse(is.na(english_in_italy[,var[4]]),0,1)

```

- Degree

*degree - richi needs to create macro degree areas for the other variable*

```{r}
table(english_in_italy$degree,useNA = "always")

```

- Minor study: called here roleL2.degree

In Italy there is not a compulsory major/minor

```{r}
table(english_in_italy$roleL2.degree,useNA = "always")
english_in_italy <- english_in_italy %>% 
  tidyr::separate(roleL2.degree,into=c("roleL2.degree","roleL2.degree.translate"),sep=" /")
english_in_italy$roleL2.degree.translate <- NULL

```

- Semester (year)

```{r}
table(english_in_italy$study.year,useNA = "always")
namesSem <- names(table(english_in_italy$study.year))

english_in_italy <- english_in_italy %>% tidyr::separate(study.year,into=c("study.year","study.year.translate"),sep=" /")
table(english_in_italy$study.year)
english_in_italy$study.year.translate <- NULL

english_in_italy$study.year <- ifelse(english_in_italy$study.year == namesSem[4], "Other",english_in_italy$study.year)

english_in_italy$study.year[which(english_in_italy$other.study.year == "Primo anno")] <- "1st year"
english_in_italy$other.study.year <- NULL
```

- Proficiency 

```{r}
# Proficiency
table(english_in_italy$prof)
namesProf <- names(table(english_in_italy$prof))
english_in_italy <- english_in_italy %>% 
  tidyr::separate(prof,into=c("prof","prof.translate"),sep=" ")
table(english_in_italy$prof)
english_in_italy$prof.translate <- NULL
```

- Check variables difference

```{r}
col_english_germany <- colnames(english_in_germany)
col_english_italy <- colnames(english_in_italy)

col_english_germany[which(!(col_english_germany %in% col_english_italy))]
col_english_italy[which(!(col_english_italy %in% col_english_germany))]

colnames(english_in_germany)[which(colnames(english_in_germany) == "global.post")] <- "globalaccess.post"

```

- Context variable

```{r}
# Label group
english_in_italy$Context <- "English in Italy"
write.csv(english_in_italy,file.path("01-cleaning_data_data","english_in_italy_cleaned.csv"),row.names = FALSE)
write.csv(english_in_germany,file.path("01-cleaning_data_data","english_in_germany_cleaned.csv"),row.names = FALSE)
```


## Italian in Australia

- Likert in Australian questionnaires have more variables than Europe context - from 31 to 33
- one variable number9 is different in Australia (same for the two contexts)/Europe (same for the two contexts)

- Attributes variable


```{r}
var <- colnames(italian_in_australia)[grep(".attrib",colnames(italian_in_australia))]
attrib <- italian_in_australia[,var]
table(attrib[,1])
table(attrib[,2])
table(attrib[,3])
table(attrib[,4])
table(attrib[,5])
table(attrib[,6])
table(attrib[,7])
table(attrib[,8])
table(attrib[,9])

italian_in_australia$succ1.attrib <- ifelse(is.na(italian_in_australia$succ1.attrib),0,1)
italian_in_australia$educ2.attrib <- ifelse(is.na(italian_in_australia$educ2.attrib),0,1)
italian_in_australia$open3.attrib <- ifelse(is.na(italian_in_australia$open3.attrib),0,1)
italian_in_australia$élite4.attrib <- ifelse(is.na(italian_in_australia$élite4.attrib),0,1)
italian_in_australia$citizen5.attrib <- ifelse(is.na(italian_in_australia$citizen5.attrib),0,1)
italian_in_australia$employable6.attrib <- ifelse(is.na(italian_in_australia$employable6.attrib),0,1)
italian_in_australia$cultured7.attrib <- ifelse(is.na(italian_in_australia$cultured7.attrib),0,1)
italian_in_australia$interesting8.attrib <- ifelse(is.na(italian_in_australia$interesting8.attrib),0,1)
```

- External influence

```{r}
var <- colnames(italian_in_australia)[grep(".external",colnames(italian_in_australia))]
external <- italian_in_australia[,var]
table(external[,1])
table(external[,2])
table(external[,3])
table(external[,4])
table(external[,5])
table(external[,6])
table(external[,7])

italian_in_australia[,var[1]] <- ifelse(is.na(italian_in_australia[,var[1]]),0,1)
italian_in_australia[,var[2]] <- ifelse(is.na(italian_in_australia[,var[2]]),0,1)
italian_in_australia[,var[3]] <- ifelse(is.na(italian_in_australia[,var[3]]),0,1)
italian_in_australia[,var[4]] <- ifelse(is.na(italian_in_australia[,var[4]]),0,1)
italian_in_australia[,var[5]] <- ifelse(is.na(italian_in_australia[,var[5]]),0,1)
italian_in_australia[,var[6]] <- ifelse(is.na(italian_in_australia[,var[6]]),0,1)
```

- Other external influence

## See this variable comapred to the other contexts

```{r}
# Other external influence
# encouragement1.influence
# insistence2.influence
# pressure3.influence
# other4.influence

# need to separate it into 4 parts
colnames(italian_in_australia)[which(colnames(italian_in_australia) == "encouragement.influence")] <- "encouragement1.influence"
colnames(italian_in_australia)[which(colnames(italian_in_australia) == "insistence.influence")] <- "insistence2.influence"
colnames(italian_in_australia)[which(colnames(italian_in_australia) == "pressure.influence")] <- "pressure3.influence"
colnames(italian_in_australia)[which(colnames(italian_in_australia) == "other.influence")] <- "other4.influence"

italian_in_australia$encouragement1.influence <- ifelse(is.na(italian_in_australia$encouragement1.influence),0,1)
italian_in_australia$insistence2.influence <- ifelse(is.na(italian_in_australia$insistence2.influence),0,1)
italian_in_australia$pressure3.influence <- ifelse(is.na(italian_in_australia$pressure3.influence),0,1)
italian_in_australia$other4.influence <- ifelse(is.na(italian_in_australia$other4.influence),0,1)

```

- Sector variable

```{r}
var <- colnames(italian_in_australia)[grep("sector",colnames(italian_in_australia))]
sector <- italian_in_australia[,var]
table(sector[,1],useNA = "always")
table(sector[,2],useNA = "always")
table(sector[,3],useNA = "always")
table(sector[,4],useNA = "always")
table(sector[,5],useNA = "always")
table(sector[,6],useNA = "always")
table(sector[,7],useNA = "always")
table(sector[,8],useNA = "always")
table(sector[,9],useNA = "always")
table(sector[,10],useNA = "always")
table(sector[,11],useNA = "always")

italian_in_australia[,var[1]] <- ifelse(is.na(italian_in_australia[,var[1]]),0,1)
italian_in_australia[,var[2]] <- ifelse(is.na(italian_in_australia[,var[2]]),0,1)
italian_in_australia[,var[3]] <- ifelse(is.na(italian_in_australia[,var[3]]),0,1)
italian_in_australia[,var[4]] <- ifelse(is.na(italian_in_australia[,var[4]]),0,1)
italian_in_australia[,var[5]] <- ifelse(is.na(italian_in_australia[,var[5]]),0,1)
italian_in_australia[,var[6]] <- ifelse(is.na(italian_in_australia[,var[6]]),0,1)
italian_in_australia[,var[7]] <- ifelse(is.na(italian_in_australia[,var[7]]),0,1)
italian_in_australia[,var[8]] <- ifelse(is.na(italian_in_australia[,var[8]]),0,1)
italian_in_australia[,var[9]] <- ifelse(is.na(italian_in_australia[,var[9]]),0,1)
italian_in_australia[,var[10]] <- ifelse(is.na(italian_in_australia[,var[10]]),0,1)

colnames(italian_in_australia)[which(colnames(italian_in_australia) == "intrelations.9sector")] <- "intrelations9.sector"
```

- Demographics

```{r}
table(italian_in_australia$Age)
table(italian_in_australia$Gender)

table(italian_in_australia$Gender,useNA = "always")
italian_in_australia$Gender[italian_in_australia$Gender == names(table(italian_in_australia$Gender))[3]] <- "Other"

```

- First Language

## Richi to identify which language 'I' could be

```{r}
table(italian_in_australia$L1)
namesL1 <- names(table(italian_in_australia$L1))
italian_in_australia$L1 <- ifelse(italian_in_australia$L1 == namesL1[2],italian_in_australia$other.other.L1,italian_in_australia$L1)
namesL1 <- names(table(italian_in_australia$L1))
# Not clear l1 language
italian_in_australia[which(italian_in_australia$L1==namesL1[4]),"Resp.ID"]
italian_in_australia$L1[italian_in_australia$L1 == namesL1[5]] <- "English"
table(italian_in_australia$L1)

italian_in_australia$other.other.L1 <- NULL
```

- Other languages

```{r}
# speak other
table(italian_in_australia$speak.other.L2,useNA = "always")
italian_in_australia$speak.other.L2 <- ifelse(italian_in_australia$speak.other.L2 == "Yes",italian_in_australia$other.speak.other.L2,italian_in_australia$speak.other.L2)
italian_in_australia$other.speak.other.L2 <- NULL

# study other
table(italian_in_australia$study.other.L2,useNA = "always")

# merge with the language studied - could be better
italian_in_australia$study.other.L2 <- ifelse(italian_in_australia$study.other.L2 == "Yes",italian_in_australia$other.study.other.L2,italian_in_australia$study.other.L2)
italian_in_australia$other.study.other.L2 <- NULL
```

- Origin

```{r}
table(italian_in_australia$origins,useNA = "always")
colnames(italian_in_australia)[colnames(italian_in_australia)=="other.origins"] <- "origins.specify"
```

- Italian before uni

Unique to Australian context

```{r}
table(italian_in_australia$italian.before.uni,italian_in_australia$years.previous.L2study,useNA = "always")

# One person said No but actually he staudies Italian less than a year
italian_in_australia$italian.before.uni[which(italian_in_australia$italian.before.uni == "No" & italian_in_australia$years.previous.L2study == "Less than a year")] <- "Yes"

italian_in_australia$italian.before.uni[which(is.na(italian_in_australia$italian.before.uni) & italian_in_australia$years.previous.L2study == "more than 6 years")] <- "Yes"

italian_in_australia$year.studyL2 <- ifelse(italian_in_australia$italian.before.uni == "No","0 years",italian_in_australia$years.previous.L2study)

table(italian_in_australia$year.studyL2,useNA = "always")                

italian_in_australia$years.previous.L2study <- NULL

table(italian_in_australia$other.years.previousL2study,italian_in_australia$year.studyL2,useNA = "always") 
namesOther <- names(table(italian_in_australia$other.years.previousL2study))

italian_in_australia$year.studyL2[italian_in_australia$other.years.previousL2study == namesOther[1]]
italian_in_australia$year.studyL2[italian_in_australia$other.years.previousL2study == namesOther[2]] <- "4-6 years"
italian_in_australia$year.studyL2[italian_in_australia$other.years.previousL2study == namesOther[3]]
italian_in_australia$year.studyL2[italian_in_australia$other.years.previousL2study == namesOther[4]] <- "more than 6 years"
italian_in_australia$year.studyL2[italian_in_australia$other.years.previousL2study == namesOther[5]]
italian_in_australia$year.studyL2[italian_in_australia$other.years.previousL2study == namesOther[6]]
italian_in_australia$year.studyL2[italian_in_australia$other.years.previousL2study == namesOther[7]] <- "Less than a year"
italian_in_australia$year.studyL2[italian_in_australia$other.years.previousL2study == namesOther[8]] <- "more than 6 years"
italian_in_australia$year.studyL2[italian_in_australia$other.years.previousL2study == namesOther[9]]

italian_in_australia$other.years.previousL2study <- NULL
italian_in_australia$italian.before.uni <- NULL
```

- L2 school

```{r}
var <- colnames(italian_in_australia)[grep("L2school",colnames(italian_in_australia))]

l2school <- italian_in_australia[,var]
table(l2school[,1],useNA = "always")
table(l2school[,2],useNA = "always")
table(l2school[,3],useNA = "always")
table(l2school[,4],useNA = "always")
table(l2school[,5],useNA = "always")
table(l2school[,6],useNA = "always")

italian_in_australia[,var[1]] <- ifelse(is.na(italian_in_australia[,var[1]]),0,1)
italian_in_australia[,var[2]] <- ifelse(is.na(italian_in_australia[,var[2]]),0,1)
italian_in_australia[,var[3]] <- ifelse(is.na(italian_in_australia[,var[3]]),0,1)
italian_in_australia[,var[4]] <- ifelse(is.na(italian_in_australia[,var[4]]),0,1)
italian_in_australia[,var[5]] <- ifelse(is.na(italian_in_australia[,var[5]]),0,1)

```

- VCE

```{r}
table(italian_in_australia$L2.VCE,useNA = "always")
```

- Other ways of studying Italian

## See if we can collapse 'other' of other.ways and L2school in one the classes available in the questionnaire

```{r}
var <- colnames(italian_in_australia)[grep("other.ways",colnames(italian_in_australia))]

otherways <- italian_in_australia[,var]
table(otherways[,1],useNA = "always")
table(otherways[,2],useNA = "always")
table(otherways[,3],useNA = "always")
table(otherways[,4],useNA = "always")
table(otherways[,5],useNA = "always")

italian_in_australia[,var[1]] <- ifelse(is.na(italian_in_australia[,var[1]]),0,1)
italian_in_australia[,var[2]] <- ifelse(is.na(italian_in_australia[,var[2]]),0,1)
italian_in_australia[,var[3]] <- ifelse(is.na(italian_in_australia[,var[3]]),0,1)
italian_in_australia[,var[4]] <- ifelse(is.na(italian_in_australia[,var[4]]),0,1)

```


- Degree Role L2

## Richi to divide in category

Maybe we could summarise :
- Unmanistic_choice1 and choice2
- Scientific_choice1 and choice2

- Other major/minor (untouched)

```{r eval=FALSE}
View(italian_in_australia[,90:ncol(italian_in_australia)])
```

- What year of uni are you in?

```{r}
table(italian_in_australia$uni1.year,useNA = "always")
table(italian_in_australia$other.uni2.year,useNA = "always")

namesOther <- names(table(italian_in_australia$other.uni2.year))

italian_in_australia$uni1.year[italian_in_australia$other.uni2.year %in% namesOther[1]] <- "Master"
italian_in_australia$uni1.year[italian_in_australia$other.uni2.year %in% namesOther[2]] <- "4th year bachelor"
italian_in_australia$uni1.year[italian_in_australia$other.uni2.year %in% namesOther[3]] <- "4th year bachelor"
italian_in_australia$uni1.year[italian_in_australia$other.uni2.year %in% namesOther[4]] <- "2nd year"
italian_in_australia$uni1.year[italian_in_australia$other.uni2.year %in% namesOther[5]] <- "Master"

italian_in_australia$other.uni2.year <- NULL
```

- In which year are you in Italian?

```{r}
table(italian_in_australia$language.studies1.year,useNA = "always")
table(italian_in_australia$other.language.studies2.year.,useNA = "always")

# We put thw other: I did the winter intensive last year so I've not yet been studying for a full year but I am in Italian 3  as second year

italian_in_australia$language.studies1.year[!is.na(italian_in_australia$other.language.studies2.year.)] <- "2nd year"

italian_in_australia$other.language.studies2.year. <- NULL
```

- beginning level

```{r}
table(italian_in_australia$beginning.level,useNA = "always")
table(italian_in_australia$X__1,useNA = "always")
italian_in_australia$X__1 <- NULL
```

- beginning level

```{r}
table(italian_in_australia$prof,useNA = "always")
```

- Year Study L2

```{r}
table(italian_in_australia$year.studyL2,useNA = "always")
```


- Context Group 

```{r}
italian_in_australia$Context <- "Italian in Australia"
write.csv(italian_in_australia,"01-cleaning_data_data/italian_in_australia_cleaned.csv",row.names = FALSE)
```


## German in Australia

- Likert in Australian questionnaires have more variables than Europe context - from 31 to 33
- one variable number9 is different in Australia (same for the two contexts)/Europe (same for the two contexts)

- Attributes variable


```{r}
var <- colnames(german_in_australia)[grep(".attrib",colnames(german_in_australia))]
attrib <- german_in_australia[,var]
table(attrib[,1])
table(attrib[,2])
table(attrib[,3])
table(attrib[,4])
table(attrib[,5])
table(attrib[,6])
table(attrib[,7])
table(attrib[,8])
table(attrib[,9])

german_in_australia$succ1.attrib <- ifelse(is.na(german_in_australia$succ1.attrib),0,1)
german_in_australia$educ2.attrib <- ifelse(is.na(german_in_australia$educ2.attrib),0,1)
german_in_australia$open3.attrib <- ifelse(is.na(german_in_australia$open3.attrib),0,1)
german_in_australia$élite4.attrib <- ifelse(is.na(german_in_australia$élite4.attrib),0,1)
german_in_australia$citizen5.attrib <- ifelse(is.na(german_in_australia$citizen5.attrib),0,1)
german_in_australia$employable6.attrib <- ifelse(is.na(german_in_australia$employable6.attrib),0,1)
german_in_australia$cultured7.attrib <- ifelse(is.na(german_in_australia$cultured7.attrib),0,1)
german_in_australia$interesting8.attrib <- ifelse(is.na(german_in_australia$interesting8.attrib),0,1)
```

- External influence

## Richi see if you can recover some of the participants that haven't written anything in the external influences

```{r}
var <- colnames(german_in_australia)[grep(".external",colnames(german_in_australia))]
external <- german_in_australia[,var]
table(external[,1])
table(external[,2])
table(external[,3])
table(external[,4])
table(external[,5])
table(external[,6])
table(external[,7])

german_in_australia[,var[1]] <- ifelse(is.na(german_in_australia[,var[1]]),0,1)
german_in_australia[,var[2]] <- ifelse(is.na(german_in_australia[,var[2]]),0,1)
german_in_australia[,var[3]] <- ifelse(is.na(german_in_australia[,var[3]]),0,1)
german_in_australia[,var[4]] <- ifelse(is.na(german_in_australia[,var[4]]),0,1)
german_in_australia[,var[5]] <- ifelse(is.na(german_in_australia[,var[5]]),0,1)
german_in_australia[,var[6]] <- ifelse(is.na(german_in_australia[,var[6]]),0,1)

```

- Other external influence

## See this variable comapred to the other contexts

```{r}
# Other external influence
# encouragement1.influence
# insistence2.influence
# pressure3.influence
# other4.influence

german_in_australia$encouragement1.influence <- ifelse(is.na(german_in_australia$encouragement1.influence),0,1)
german_in_australia$insistence2.influence <- ifelse(is.na(german_in_australia$insistence2.influence),0,1)
german_in_australia$pressure3.influence <- ifelse(is.na(german_in_australia$pressure3.influence),0,1)
german_in_australia$other4.influence <- ifelse(is.na(german_in_australia$other4.influence),0,1)

```

- Sector variable

## uchi could summarise the other variable

```{r}
var <- colnames(german_in_australia)[grep("sector",colnames(german_in_australia))]
sector <- german_in_australia[,var]
table(sector[,1],useNA = "always")
table(sector[,2],useNA = "always")
table(sector[,3],useNA = "always")
table(sector[,4],useNA = "always")
table(sector[,5],useNA = "always")
table(sector[,6],useNA = "always")
table(sector[,7],useNA = "always")
table(sector[,8],useNA = "always")
table(sector[,9],useNA = "always")
table(sector[,10],useNA = "always")
table(sector[,11],useNA = "always")

german_in_australia[,var[1]] <- ifelse(is.na(german_in_australia[,var[1]]),0,1)
german_in_australia[,var[2]] <- ifelse(is.na(german_in_australia[,var[2]]),0,1)
german_in_australia[,var[3]] <- ifelse(is.na(german_in_australia[,var[3]]),0,1)
german_in_australia[,var[4]] <- ifelse(is.na(german_in_australia[,var[4]]),0,1)
german_in_australia[,var[5]] <- ifelse(is.na(german_in_australia[,var[5]]),0,1)
german_in_australia[,var[6]] <- ifelse(is.na(german_in_australia[,var[6]]),0,1)
german_in_australia[,var[7]] <- ifelse(is.na(german_in_australia[,var[7]]),0,1)
german_in_australia[,var[8]] <- ifelse(is.na(german_in_australia[,var[8]]),0,1)
german_in_australia[,var[9]] <- ifelse(is.na(german_in_australia[,var[9]]),0,1)
german_in_australia[,var[10]] <- ifelse(is.na(german_in_australia[,var[10]]),0,1)

colnames(german_in_australia)[which(colnames(german_in_australia) == "intrelations.9sector")] <- "intrelations9.sector"
```

- Demographics

```{r}
table(german_in_australia$Age)

table(german_in_australia$Gender,useNA = "always")
german_in_australia$Gender[german_in_australia$Gender == names(table(german_in_australia$Gender))[3]] <- "Other"

```

- First Language

## Richi to identify which language 'I' could be

```{r}
table(german_in_australia$L1)
namesL1 <- names(table(german_in_australia$L1))
german_in_australia$L1 <- ifelse(german_in_australia$L1 == namesL1[2],german_in_australia$other.other.L1,german_in_australia$L1)
namesL1 <- names(table(german_in_australia$L1))
german_in_australia$L1[german_in_australia$L1 == namesL1[8]] <- "English and Dutch"
table(german_in_australia$L1)

german_in_australia$other.other.L1 <- NULL
```

- Other languages

```{r}
# speak other
table(german_in_australia$speak.other.L2,useNA = "always")
german_in_australia$speak.other.L2 <- ifelse(german_in_australia$speak.other.L2 == "Yes",german_in_australia$other.speak.other.L2,german_in_australia$speak.other.L2)
german_in_australia$other.speak.other.L2 <- NULL

# study other
table(german_in_australia$study.other.L2,useNA = "always")

# merge with the language studied - could be better
german_in_australia$study.other.L2 <- ifelse(german_in_australia$study.other.L2 == "Yes",german_in_australia$other.study.other.L2,german_in_australia$study.other.L2)
german_in_australia$other.study.other.L2 <- NULL
```

- Origin

```{r}
table(german_in_australia$origins,useNA = "always")
colnames(german_in_australia)[colnames(german_in_australia)=="other.origins"] <- "origins.specify"
namesOrigin <- names(table(german_in_australia$origins))

german_in_australia$origins[german_in_australia$origins %in% "If YES, please specify"] <- "Yes"

```

- Italian before uni

Unique to Australian context

```{r}
table(german_in_australia$german.before.uni,german_in_australia$years.previous.L2study,useNA = "always")

german_in_australia$german.before.uni[german_in_australia$german.before.uni == "No" & german_in_australia$years.previous.L2study == "more than 6 years"] <- "Yes"
table(german_in_australia$german.before.uni,german_in_australia$years.previous.L2study,useNA = "always")

# recode the variable
german_in_australia$year.studyL2 <- ifelse(german_in_australia$german.before.uni == "No","0 years",german_in_australia$years.previous.L2study)

table(german_in_australia$year.studyL2,useNA = "always")                

german_in_australia$years.previous.L2study <- NULL

# Other variable
table(german_in_australia$other.years.previousL2study,german_in_australia$year.studyL2,useNA = "always") 
namesOther <- names(table(german_in_australia$other.years.previousL2study))

german_in_australia$year.studyL2[german_in_australia$other.years.previousL2study == namesOther[1]] <- "Less than a year"
german_in_australia$year.studyL2[german_in_australia$other.years.previousL2study == namesOther[2]]
german_in_australia$year.studyL2[german_in_australia$other.years.previousL2study == namesOther[3]]
german_in_australia$year.studyL2[german_in_australia$other.years.previousL2study == namesOther[4]] 
german_in_australia$year.studyL2[german_in_australia$other.years.previousL2study == namesOther[5]]
german_in_australia$year.studyL2[german_in_australia$other.years.previousL2study == namesOther[6]] <- "more than 6 years"

german_in_australia$other.years.previousL2study <- NULL
german_in_australia$german.before.uni <- NULL
```

- L2 school

```{r}
var <- colnames(german_in_australia)[grep("L2school",colnames(german_in_australia))]

l2school <- german_in_australia[,var]
table(l2school[,1],useNA = "always")
table(l2school[,2],useNA = "always")
table(l2school[,3],useNA = "always")
table(l2school[,4],useNA = "always")
table(l2school[,5],useNA = "always")
table(l2school[,6],useNA = "always")

german_in_australia[,var[1]] <- ifelse(is.na(german_in_australia[,var[1]]),0,1)
german_in_australia[,var[2]] <- ifelse(is.na(german_in_australia[,var[2]]),0,1)
german_in_australia[,var[3]] <- ifelse(is.na(german_in_australia[,var[3]]),0,1)
german_in_australia[,var[4]] <- ifelse(is.na(german_in_australia[,var[4]]),0,1)
german_in_australia[,var[5]] <- ifelse(is.na(german_in_australia[,var[5]]),0,1)

```

- VCE

```{r}
table(german_in_australia$L2.VCE,useNA = "always")
```

- Other ways of studying Italian

## See if we can collapse 'other' of other.ways and L2school in one the classes available in the questionnaire

```{r}
var <- colnames(german_in_australia)[grep("other.ways",colnames(german_in_australia))]

otherways <- german_in_australia[,var]
table(otherways[,1],useNA = "always")
table(otherways[,2],useNA = "always")
table(otherways[,3],useNA = "always")
table(otherways[,4],useNA = "always")
table(otherways[,5],useNA = "always")

german_in_australia[,var[1]] <- ifelse(is.na(german_in_australia[,var[1]]),0,1)
german_in_australia[,var[2]] <- ifelse(is.na(german_in_australia[,var[2]]),0,1)
german_in_australia[,var[3]] <- ifelse(is.na(german_in_australia[,var[3]]),0,1)
german_in_australia[,var[4]] <- ifelse(is.na(german_in_australia[,var[4]]),0,1)

german_in_australia$other5.other.ways <- german_in_australia$`SAME (OTHER)`
german_in_australia$other5.other.ways  <- NULL

colnames(german_in_australia)[colnames(german_in_australia) == "SAME (OTHER)"] <- "other5.other.ways"
```


- Degree Role L2

## Richi to divide in category

Maybe we could summarise :
  - Unmanistic_choice1 and choice2
- Scientific_choice1 and choice2

- Other major/minor (untouched)

```{r}
#View(german_in_australia[,90:ncol(german_in_australia)])

var <- colnames(german_in_australia)[grep("degree|breadth",colnames(german_in_australia))]

ndegree <- rowSums(!is.na(german_in_australia[,var]))

```

- What year of uni are you in?

```{r}
table(german_in_australia$uni1.year,useNA = "always")
table(german_in_australia$other.uni2.year,useNA = "always")

namesOther <- names(table(german_in_australia$other.uni2.year))

german_in_australia$uni1.year[german_in_australia$other.uni2.year %in% namesOther[1]] <- "Master"
german_in_australia$uni1.year[german_in_australia$other.uni2.year %in% namesOther[2]] <- "4th year bachelor"
german_in_australia$uni1.year[german_in_australia$other.uni2.year %in% namesOther[3]] <- "4th year bachelor"
german_in_australia$uni1.year[german_in_australia$other.uni2.year %in% namesOther[4]] <- "1st year"
german_in_australia$uni1.year[german_in_australia$other.uni2.year %in% namesOther[5]] <- "7th year"
german_in_australia$uni1.year[german_in_australia$other.uni2.year %in% namesOther[6]] <- "1st year"

german_in_australia$other.uni2.year <- NULL
```

- In which year are you in Italian?

```{r}
table(german_in_australia$language.studies1.year,useNA = "always")
table(german_in_australia$other.language.studies2.year.,useNA = "always")

german_in_australia$other.language.studies2.year. <- NULL
```

- beginning level

```{r}
table(german_in_australia$beginning.level,useNA = "always")
table(german_in_australia$other.beginning.level.1,useNA = "always")

namesOther <- names(table(german_in_australia$other.beginning.level.1))
german_in_australia$beginning.level[german_in_australia$other.beginning.level.1 %in% namesOther[1]] <- "German 1 (Australian National University)"
german_in_australia$beginning.level[german_in_australia$other.beginning.level.1 %in% namesOther[2]] <- "German 2"
german_in_australia$beginning.level[german_in_australia$other.beginning.level.1 %in% namesOther[3]] <- namesOther[3]
german_in_australia$beginning.level[german_in_australia$other.beginning.level.1 %in% namesOther[4]] <- namesOther[4]
german_in_australia$beginning.level[german_in_australia$other.beginning.level.1 %in% namesOther[5]] <- namesOther[5]

german_in_australia$other.beginning.level.1 <- NULL

```

- beginning level

```{r}
table(german_in_australia$prof,useNA = "always")
```

- Year Study L2

```{r}
table(german_in_australia$year.studyL2,useNA = "always")
```


- Context Group 

```{r}
german_in_australia$Context <- "German in Australia"

colnames(german_in_australia)[!(colnames(german_in_australia) %in% colnames(italian_in_australia))]
colnames(italian_in_australia)[!(colnames(italian_in_australia) %in% colnames(german_in_australia))]

# In german and not in Italian in Australia - need to be collapsed as Umanistic_choice1 etc..
#[1] "arts.major.degree1"         "arts.minor.breadth.degree2" "arts.breadth.degree3"      
#[4] "arts.diploma.degree3"       "science.major.degree4"      "science.minor.breadth5"    
#[7] "science.breadth.degree6"    "other.degree.7" 

# In italian in Australia this variable is only two columsn while in gemran in Australia it is several columns (see lines above)
#> colnames(italian_in_australia)[!(colnames(italian_in_australia) %in% colnames(german_in_australia))]
#[1] "degree.roleL2"       "other.degree.roleL2"

write.csv(german_in_australia,file.path("01-cleaning_data_data","german_in_australia_cleaned.csv"),row.names = FALSE)
```

# Read cleaned datasets

```{r message=FALSE}
english_in_germany <- read_csv(file.path("01-cleaning_data_data","english_in_germany_cleaned.csv"))
english_in_italy <- read_csv(file.path("01-cleaning_data_data","english_in_italy_cleaned.csv"))

italian_in_australia <- read_csv(file.path("01-cleaning_data_data/italian_in_australia_cleaned.csv"))
german_in_australia <- read_csv("01-cleaning_data_data/german_in_australia_cleaned.csv")
```

## After Richi's coding 

1. English in Germany

```{r}
english_in_germany_cleaned_csv <- read_excel("columns_recoded_demographics/english_in_germany_cleaned.csv.xlsx")
colnames(english_in_germany_cleaned_csv)[!(colnames(english_in_germany_cleaned_csv) %in% colnames(english_in_germany))]
english_in_germany_cleaned_red <- subset(english_in_germany_cleaned_csv,select=c("Resp.ID","other.attrib.richi","other.external.richi","other.sector.richi","other.year.studyL2.reduced","other.year.studyL2.richi","other.other.ways.richi","other.degree.richi"))
english_in_germany <- merge(english_in_germany,english_in_germany_cleaned_red,all = TRUE)

# other.attrib.richi
table(english_in_germany$other.attrib.richi,english_in_germany$other.comment9.attrib)
sum(!is.na(english_in_germany$other.comment9.attrib))
sum(!is.na(english_in_germany$other.attrib.richi))
english_in_germany[,"other.comment9.attrib"] <- english_in_germany$other.attrib.richi
table(english_in_germany$other.comment9.attrib)

# other.attrib.richi
table(english_in_germany$other.external.richi,english_in_germany$other7.external)
sum(!is.na(english_in_germany$other7.external))
sum(!is.na(english_in_germany$other.external.richi))
english_in_germany[,"other7.external"] <- english_in_germany$other.external.richi
table(english_in_germany$other7.external)

english_in_germany$noextern6.external <- ifelse(english_in_germany$other7.external %in% "M.NO.EXTERNAL.FACTORS",1,english_in_germany$noextern6.external)

# other11.sector
table(english_in_germany$other.sector.richi,english_in_germany$other11.sector)
sum(!is.na(english_in_germany$other11.sector))
sum(!is.na(english_in_germany$other.sector.richi))
english_in_germany[,"other11.sector"] <- english_in_germany$other.sector.richi
table(english_in_germany$other11.sector)
  
english_in_germany$teaching3.sector <- ifelse(english_in_germany$other11.sector %in% "M.TEACHING",1,english_in_germany$teaching3.sector)
      
# other.year.studyL2.richi
table(english_in_germany$other.year.studyL2.richi,english_in_germany$other.year.studyL2)
sum(!is.na(english_in_germany$other.year.studyL2))
sum(!is.na(english_in_germany$other.year.studyL2.richi))
english_in_germany[,"other.year.studyL2"] <- english_in_germany$other.year.studyL2.richi
table(english_in_germany$other.year.studyL2)

# other.other.ways.richi
table(english_in_germany$other.other.ways.richi,english_in_germany$other5.other.ways)
sum(!is.na(english_in_germany$other5.other.ways))
sum(!is.na(english_in_germany$other.other.ways.richi))
english_in_germany[,"other5.other.ways"] <- english_in_germany$other.other.ways.richi
table(english_in_germany$other5.other.ways)

# other.other.ways.richi
table(english_in_germany$other.degree.richi,english_in_germany$other.degree1)
sum(!is.na(english_in_germany$other.degree1))
sum(!is.na(english_in_germany$other.degree.richi))
english_in_germany[,"other.degree1"] <- english_in_germany$other.degree.richi
table(english_in_germany$other.degree1)

# substitute degree-other with Richi's degree
english_in_germany$degree <- ifelse(english_in_germany$degree == "Other",english_in_germany$other.degree.richi,english_in_germany$degree)
table(english_in_germany$degree,useNA = "always")

english_in_germany$degree <- ifelse(english_in_germany$degree == "Lehramt with English as a teaching subject","LA",english_in_germany$degree)
table(english_in_germany$degree)

write_csv(english_in_germany,"01-cleaning_data_data/english_in_germany_cleaned_recoded.csv")
```

1. English in Italy

```{r}
english_in_italy_cleaned_csv <-  read_excel("columns_recoded_demographics/english_in_italy_cleaned.csv.xlsx")
colnames(english_in_italy_cleaned_csv)[!(colnames(english_in_italy_cleaned_csv) %in% colnames(english_in_italy))]
english_in_germany_cleaned_red <- subset(english_in_italy_cleaned_csv,select=c("Resp.ID","other.attrib.richi","other.external.richi","other.sector.richi","other.year.studyL2.richi","other.other.ways.richi"))
english_in_italy <- merge(english_in_italy,english_in_germany_cleaned_red,all = TRUE)

# other.attrib.richi
table(english_in_italy$other.attrib.richi,english_in_italy$other.comment9.attrib)
sum(!is.na(english_in_italy$other.comment9.attrib))
sum(!is.na(english_in_italy$other.attrib.richi))
english_in_italy[,"other.comment9.attrib"] <- english_in_italy$other.attrib.richi
#table(english_in_italy$other.comment9.attrib)

# other.attrib.richi
table(english_in_italy$other.external.richi,english_in_italy$other7.external)
sum(!is.na(english_in_italy$other7.external))
sum(!is.na(english_in_italy$other.external.richi))
english_in_italy[,"other7.external"] <- english_in_italy$other.external.richi
#table(english_in_italy$other7.external)

english_in_italy$noextern6.external <- ifelse(english_in_italy$other7.external == "M.NO.EXTERNAL.FACTORS",1,english_in_italy$noextern6.external )

# other11.sector
table(english_in_italy$other.sector.richi,english_in_italy$other11.sector)
sum(!is.na(english_in_italy$other11.sector))
sum(!is.na(english_in_italy$other.sector.richi))
english_in_italy[,"other11.sector"] <- english_in_italy$other.sector.richi
#table(english_in_italy$other11.sector)

# other.year.studyL2.richi
table(english_in_italy$other.year.studyL2.richi,english_in_italy$other.year.studyL2)
sum(!is.na(english_in_italy$other.year.studyL2))
sum(!is.na(english_in_italy$other.year.studyL2.richi))
english_in_italy[,"other.year.studyL2"] <- english_in_italy$other.year.studyL2.richi
#table(english_in_italy$other.year.studyL2)

# other.other.ways.richi
table(english_in_italy$other.other.ways.richi,english_in_italy$other5.other.ways)
sum(!is.na(english_in_italy$other5.other.ways))
sum(!is.na(english_in_italy$other.other.ways.richi))
english_in_italy[,"other5.other.ways"] <- english_in_italy$other.other.ways.richi
#table(english_in_italy$other5.other.ways)

# in English in Italy the degree is always only one 

write_csv(english_in_italy,"01-cleaning_data_data/english_in_italy_cleaned_recoded.csv")
```

- German in Australia

```{r}
german_in_australia_cleaned_csv <- read_excel("columns_recoded_demographics/german_in_australia_cleaned.csv.xlsx")
colnames(german_in_australia_cleaned_csv)[!(colnames(german_in_australia_cleaned_csv) %in% colnames(german_in_australia))]
german_in_australia_cleaned_red <- subset(german_in_australia_cleaned_csv,select=c("Resp.ID","other.attrib.richi","other.external.richi","other.sector.richi","other.L2school.richi","other.other.ways.richi","degree","degree.role"))
german_in_australia <- merge(german_in_australia,german_in_australia_cleaned_red,all = TRUE)

# other.attrib.richi
table(german_in_australia$other.attrib.richi,german_in_australia$other.comment9.attrib)
sum(!is.na(german_in_australia$other.comment9.attrib))
sum(!is.na(german_in_australia$other.attrib.richi))
german_in_australia[,"other.comment9.attrib"] <- german_in_australia$other.attrib.richi
table(german_in_australia$other.comment9.attrib)
table(english_in_italy$other.comment9.attrib)
table(english_in_germany$other.comment9.attrib)

# other.attrib.richi
table(german_in_australia$other.external.richi,german_in_australia$other7.external)
sum(!is.na(german_in_australia$other7.external))
sum(!is.na(german_in_australia$other.external.richi))
german_in_australia[,"other7.external"] <- german_in_australia$other.external.richi
#table(german_in_australia$other7.external)

german_in_australia$noextern6.external <- ifelse(german_in_australia$other7.external == "M.NO.EXTERNAL.FACTORS",1,german_in_australia$noextern6.external )

# other11.sector
table(german_in_australia$other.sector.richi,german_in_australia$other11.sector)
sum(!is.na(german_in_australia$other11.sector))
sum(!is.na(german_in_australia$other.sector.richi))
german_in_australia[,"other11.sector"] <- german_in_australia$other.sector.richi
#table(german_in_australia$other11.sector)

german_in_australia$intrelations9.sector <- ifelse(german_in_australia$other11.sector == "M.INTERNATIONAL.RELATIONS",1,german_in_australia$intrelations9.sector)

# other.year.studyL2.richi
table(german_in_australia$other.L2school.richi,german_in_australia$other6.L2school)
sum(!is.na(german_in_australia$other6.L2school))
sum(!is.na(german_in_australia$other.L2school.richi))
german_in_australia[,"other6.L2school"] <- german_in_australia$other.L2school.richi
#table(german_in_australia$other6.L2school)

# other.other.ways.richi
table(german_in_australia$other.other.ways.richi,german_in_australia$other5.other.ways)
sum(!is.na(german_in_australia$other5.other.ways))
sum(!is.na(german_in_australia$other.other.ways.richi))
german_in_australia[,"other5.other.ways"] <- german_in_australia$other.other.ways.richi
#table(german_in_australia$other5.other.ways)

german_in_australia$private.lessons1.other.ways <- ifelse(german_in_australia$other5.other.ways == "M.PRIVATE.LESSONS",1,german_in_australia$private.lessons1.other.ways)

german_in_australia$online.course4.other.ways <- ifelse(german_in_australia$other5.other.ways == "M.ONLINE.COURSE" | german_in_australia$other5.other.ways == "ONLINE.COURSE",1,german_in_australia$online.course4.other.ways)

# in English in Italy the degree is always only one 
write_csv(german_in_australia,"01-cleaning_data_data/german_in_australia_cleaned_recoded.csv")
```

- Italian in Australia

```{r}
italian_in_australia_cleaned_csv <- read_excel("columns_recoded_demographics/italian_in_australia_cleaned.csv.xlsx")
colnames(italian_in_australia_cleaned_csv)[!(colnames(italian_in_australia_cleaned_csv) %in% colnames(italian_in_australia))]
italian_in_australia_cleaned_red <- subset(italian_in_australia_cleaned_csv,select=c("Resp.ID","other.attrib.richi","other.external.richi","other.sector.richi","other.L2school.richi","other.other.ways.richi","degree","degree.role"))
italian_in_australia <- merge(italian_in_australia,italian_in_australia_cleaned_red,all = TRUE)

# other.attrib.richi
table(italian_in_australia$other.attrib.richi,italian_in_australia$other.comment9.attrib)
sum(!is.na(italian_in_australia$other.comment9.attrib))
sum(!is.na(italian_in_australia$other.attrib.richi))
italian_in_australia[,"other.comment9.attrib"] <- italian_in_australia$other.attrib.richi
table(italian_in_australia$other.comment9.attrib)

# other.attrib.richi
table(italian_in_australia$other.external.richi,italian_in_australia$other7.external)
sum(!is.na(italian_in_australia$other7.external))
sum(!is.na(italian_in_australia$other.external.richi))
italian_in_australia[,"other7.external"] <- italian_in_australia$other.external.richi
table(italian_in_australia$other7.external)

italian_in_australia$noextern6.external <- ifelse(italian_in_australia$other7.external %in% "M.NO.EXTERNAL.FACTORS",1,italian_in_australia$noextern6.external)

italian_in_australia$parents1.external <- ifelse(italian_in_australia$other7.external %in% "M.INFLUENCE.FROM.PARENTS",1,italian_in_australia$parents1.external)

table(italian_in_australia$other7.external)

# other11.sector
table(italian_in_australia$other.sector.richi,italian_in_australia$other11.sector)
sum(!is.na(italian_in_australia$other11.sector))
sum(!is.na(italian_in_australia$other.sector.richi))
italian_in_australia[,"other11.sector"] <- italian_in_australia$other.sector.richi
table(italian_in_australia$other11.sector)

italian_in_australia$intrelations9.sector <- ifelse(italian_in_australia$other11.sector %in% "M.INTERNATIONAL.RELATIONS",1,italian_in_australia$intrelations9.sector)


# other.year.studyL2.richi
table(italian_in_australia$other.L2school.richi,italian_in_australia$other6.L2school)
sum(!is.na(italian_in_australia$other6.L2school))
sum(!is.na(italian_in_australia$other.L2school.richi))
italian_in_australia[,"other6.L2school"] <- italian_in_australia$other.L2school.richi
table(italian_in_australia$other6.L2school)

italian_in_australia$schooL2country5.L2school <- ifelse(italian_in_australia$other6.L2school %in% "M.SCHOOL.IN.ITALY",1,italian_in_australia$schooL2country5.L2school)

# other.other.ways.richi
table(italian_in_australia$other.other.ways.richi,italian_in_australia$other5.other.ways)
sum(!is.na(italian_in_australia$other5.other.ways))
sum(!is.na(italian_in_australia$other.other.ways.richi))
italian_in_australia[,"other5.other.ways"] <- italian_in_australia$other.other.ways.richi
table(italian_in_australia$other5.other.ways)

italian_in_australia$private.lessons1.other.ways <- ifelse(italian_in_australia$other5.other.ways %in% "M.PRIVATE.LESSONS",1,italian_in_australia$private.lessons1.other.ways)

write_csv(italian_in_australia,"01-cleaning_data_data/italian_in_australia_cleaned_recoded.csv")
```


- read recoded datasets

```{r}
italian_in_australia <- read_csv("01-cleaning_data_data/italian_in_australia_cleaned_recoded.csv")
german_in_australia <- read_csv("01-cleaning_data_data/german_in_australia_cleaned_recoded.csv")
english_in_germany <- read_csv("01-cleaning_data_data/english_in_germany_cleaned_recoded.csv")
english_in_italy <- read_csv("01-cleaning_data_data/english_in_italy_cleaned_recoded.csv")

english_in_italy1 <- read_csv("01-cleaning_data_data/english_in_italy_cleaned.csv")
```

- Merge the Australian contexts

```{r}
dim(italian_in_australia)
dim(german_in_australia)

colnames(german_in_australia)[!(colnames(german_in_australia) %in% colnames(italian_in_australia))]
colnames(italian_in_australia)[!(colnames(italian_in_australia) %in% colnames(german_in_australia))]
colnames(german_in_australia)[!(colnames(german_in_australia) %in% colnames(english_in_italy))]
colnames(german_in_australia)[!(colnames(german_in_australia) %in% colnames(english_in_germany))]
colnames(italian_in_australia)[!(colnames(italian_in_australia) %in% colnames(english_in_italy))]
colnames(italian_in_australia)[!(colnames(italian_in_australia) %in% colnames(english_in_germany))]


australian <- merge(italian_in_australia,german_in_australia,all = TRUE)

write.csv(australian,"01-cleaning_data_data/australian_recoded.csv",row.names = FALSE)
```

- Merge the European contexts

```{r}
dim(english_in_germany)
dim(english_in_italy)

colnames(english_in_germany)[!(colnames(english_in_germany) %in% colnames(english_in_italy))]
colnames(english_in_italy)[!(colnames(english_in_italy) %in% colnames(english_in_germany))]

european <- merge(english_in_germany,english_in_italy,all = TRUE)

write.csv(european,"01-cleaning_data_data/european_recoded.csv",row.names = FALSE)
```



